<!-- gallery.html -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>üñºÔ∏è Galer√≠a ‚Äì Boda Mar & Juan Carlos</title>
  <style>
    /* estilos omitidos para brevedad, usa los que ya tienes */
    .categorias {
      text-align: center;
      margin-bottom: 2rem;
      flex-wrap: wrap;
      display: flex;
      justify-content: center;
      gap: 0.8rem;
    }
    .categorias button {
      padding: 0.5rem 1rem;
      border-radius: 20px;
      border: none;
      background: #764ba2;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    .categorias button.active {
      background: #667eea;
    }
    .pagination {
      text-align: center;
      margin-top: 1.5rem;
    }
    .pagination button {
      padding: 0.4rem 0.8rem;
      margin: 0 0.4rem;
      border: none;
      border-radius: 8px;
      background: #ccc;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <section class="header">
    <div class="heart">Mar üíï JC</div>
    <h1>Galer√≠a de Fotos</h1>
    <a href="/" class="btn">üì∑ Subir M√°s Fotos</a>
  </section>

  <div class="categorias" id="categorias"></div>
  <section class="gallery" id="galeria"></section>
  <div class="pagination" id="paginacion"></div>

  <div class="modal" id="modal" onclick="cerrarModal()">
    <img id="modalImg" src="">
  </div>

  <!-- JSON embebido -->
  <script>
    const fotosPorCategoria = {{ fotos_por_categoria | tojson }};
  </script>

  <script>
    let categoriaActual = "";
    let paginaActual = 1;
    const fotosPorPagina = 6;

    const galeria = document.getElementById("galeria");
    const categoriasDiv = document.getElementById("categorias");
    const paginacion = document.getElementById("paginacion");

    const categorias = Object.keys(fotosPorCategoria).filter(cat => fotosPorCategoria[cat].length > 0);

    function mostrarCategorias() {
      categoriasDiv.innerHTML = '';
      categorias.forEach(cat => {
        const btn = document.createElement("button");
        btn.textContent = cat;
        btn.onclick = () => {
          categoriaActual = cat;
          paginaActual = 1;
          actualizarGaleria();
          actualizarCategorias();
        };
        if (cat === categoriaActual) btn.classList.add("active");
        categoriasDiv.appendChild(btn);
      });
    }

    function actualizarCategorias() {
      [...categoriasDiv.children].forEach(btn => {
        btn.classList.toggle("active", btn.textContent === categoriaActual);
      });
    }

    function actualizarGaleria() {
      galeria.innerHTML = '';
      const fotos = fotosPorCategoria[categoriaActual] || [];
      const inicio = (paginaActual - 1) * fotosPorPagina;
      const paginadas = fotos.slice(inicio, inicio + fotosPorPagina);

      paginadas.forEach(foto => {
        const div = document.createElement("div");
        div.className = "photo";
        div.onclick = () => verFoto(foto);
        div.innerHTML = `<img src="${foto}" alt="Foto de boda">`;
        galeria.appendChild(div);
      });

      actualizarPaginacion(fotos.length);
    }

    function actualizarPaginacion(total) {
      paginacion.innerHTML = '';
      const totalPaginas = Math.ceil(total / fotosPorPagina);

      if (totalPaginas <= 1) return;

      if (paginaActual > 1) {
        const prev = document.createElement("button");
        prev.textContent = "‚óÄÔ∏è";
        prev.onclick = () => {
          paginaActual--;
          actualizarGaleria();
        };
        paginacion.appendChild(prev);
      }

      const info = document.createElement("span");
      info.textContent = `P√°gina ${paginaActual} de ${totalPaginas}`;
      paginacion.appendChild(info);

      if (paginaActual < totalPaginas) {
        const next = document.createElement("button");
        next.textContent = "‚ñ∂Ô∏è";
        next.onclick = () => {
          paginaActual++;
          actualizarGaleria();
        };
        paginacion.appendChild(next);
      }
    }

    function verFoto(src) {
      const modal = document.getElementById('modal');
      const img = document.getElementById('modalImg');
      img.src = src;
      modal.style.display = 'flex';
    }

    function cerrarModal() {
      document.getElementById('modal').style.display = 'none';
    }

    // Inicializar con primera categor√≠a
    categoriaActual = categorias[0];
    mostrarCategorias();
    actualizarGaleria();
  </script>
</body>
</html>